S + had + verb in participle +.. 
Thời quá khứ hoàn thành được dùng để diễn đạt:

(1) một hành động xảy ra trước một hành động khác trong quá khứ, trong câu thường có có 2 hành động:
Thời quá khứ hoàn thành thường được dùng với 3 phó từ chỉ thời gian là: after, before và when.

 - S + simple past + after + S + past perfect
 - S + past perfect + before + S + simple past
 - Before + S + simple past + S + past perfect 

 Phó từ when có thể được dùng thay cho after và before trong cả 4 mẫu trên mà không làm thay đổi ý nghĩa của câu. Chúng ta vẫn biết hành động nào xảy ra trước do có sử dụng quá khứ hoàn thành.

ex:
 The police came when the robber had gone away.

(2) Một trạng thái đã tồn tại một thời gian trong quá khứ nhưng đã chấm dứt trước hiện tại. Trường hợp này tương tự trường hợp 

(3) đối với hiện tại hoàn thành nhưng trong trường hợp này không có liên hệ gì với hiện tại.

ex:
 John had lived in New York for ten years before he moved to VN.
 